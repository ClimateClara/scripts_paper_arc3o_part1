<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>SAMSIM: mo_layer_dynamics Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li class="current"><a href="namespaces.html"><span>Modules</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="namespaces.html"><span>Modules&nbsp;List</span></a></li>
      <li><a href="namespacemembers.html"><span>Module&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<h1>mo_layer_dynamics Module Reference</h1>  </div>
</div>
<div class="contents">

<p>Mo_layer_dynamics contains all subroutines for the growth and shrinking of layer thickness.  
<a href="#_details">More...</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">subroutine&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemo__layer__dynamics.html#a4b67e1200af1131f76796868c2552a57">layer_dynamics</a> (phi, N_active, Nlayer, N_bottom, N_middle, N_top, m, S_abs, H_abs, thick, thick_0, T_bottom, S_bu_bottom, bottom_flag, debug_flag, N_bgc, bgc_abs, bgc_bottom)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Organizes the Semi-Adaptive grid SAMSIM uses.  <a href="#a4b67e1200af1131f76796868c2552a57"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">subroutine&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemo__layer__dynamics.html#aadc5de505c96dad5c7fe5bdb233102a6">top_melt</a> (Nlayer, N_active, N_bottom, N_middle, N_top, thick_0, m, S_abs, H_abs, thick, N_bgc, bgc_abs)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">subroutine&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemo__layer__dynamics.html#ad2f5a196bac29bfdc04d442b0b722a24">top_grow</a> (Nlayer, N_active, N_bottom, N_middle, N_top, thick_0, m, S_abs, H_abs, thick, N_bgc, bgc_abs)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Top grow subroutine.  <a href="#ad2f5a196bac29bfdc04d442b0b722a24"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Mo_layer_dynamics contains all subroutines for the growth and shrinking of layer thickness. </p>
<p>The middle layers have flexible thickness in contrast to the lower and upper layers which have static thickness. The details are provided in the separate subroutines.</p>
<dl class="author"><dt><b>Author:</b></dt><dd>Philipp Griewank, IMPRS</dd></dl>
<dl class="user"><dt><b>Revision History</b></dt><dd>Shrinking and growth at the bottom are started by Philipp Griewank, IMPRS (2010-07-28) </dd></dl>
<hr/><h2>Function/Subroutine Documentation</h2>
<a class="anchor" id="a4b67e1200af1131f76796868c2552a57"></a><!-- doxytag: member="mo_layer_dynamics::layer_dynamics" ref="a4b67e1200af1131f76796868c2552a57" args="(phi, N_active, Nlayer, N_bottom, N_middle, N_top, m, S_abs, H_abs, thick, thick_0, T_bottom, S_bu_bottom, bottom_flag, debug_flag, N_bgc, bgc_abs, bgc_bottom)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mo_layer_dynamics::layer_dynamics </td>
          <td>(</td>
          <td class="paramtype">REAL(wp),dimension(nlayer),intent(in)&nbsp;</td>
          <td class="paramname"> <em>phi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">INTEGER,intent(inout)&nbsp;</td>
          <td class="paramname"> <em>N_active</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">INTEGER,intent(in)&nbsp;</td>
          <td class="paramname"> <em>Nlayer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">INTEGER,intent(in)&nbsp;</td>
          <td class="paramname"> <em>N_bottom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">INTEGER,intent(in)&nbsp;</td>
          <td class="paramname"> <em>N_middle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">INTEGER,intent(in)&nbsp;</td>
          <td class="paramname"> <em>N_top</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL(wp),dimension(nlayer),intent(inout)&nbsp;</td>
          <td class="paramname"> <em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL(wp),dimension(nlayer),intent(inout)&nbsp;</td>
          <td class="paramname"> <em>S_abs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL(wp),dimension(nlayer),intent(inout)&nbsp;</td>
          <td class="paramname"> <em>H_abs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL(wp),dimension(nlayer),intent(inout)&nbsp;</td>
          <td class="paramname"> <em>thick</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL(wp),intent(in)&nbsp;</td>
          <td class="paramname"> <em>thick_0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL(wp),intent(in)&nbsp;</td>
          <td class="paramname"> <em>T_bottom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL(wp),intent(in)&nbsp;</td>
          <td class="paramname"> <em>S_bu_bottom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">INTEGER,intent(in)&nbsp;</td>
          <td class="paramname"> <em>bottom_flag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">INTEGER,intent(in)&nbsp;</td>
          <td class="paramname"> <em>debug_flag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">INTEGER,intent(in)&nbsp;</td>
          <td class="paramname"> <em>N_bgc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL(wp),dimension(nlayer,n_bgc),intent(inout),optional&nbsp;</td>
          <td class="paramname"> <em>bgc_abs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL(wp),dimension(n_bgc),intent(in),optional&nbsp;</td>
          <td class="paramname"> <em>bgc_bottom</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Organizes the Semi-Adaptive grid SAMSIM uses. </p>
<p>Modifies the grid and all core variables due to growth or melt. Calls the different subroutines according to current conditions. All subroutines can be called with or without biogeochemical tracers active, which is triggered by providing bgc_abs when calling the subroutine. See Griewank PhD thesis for a full description of the grid.</p>
<p>Conditions under which following layer dynamics subroutines are called:</p>
<ul>
<li>bottom_melt: lowest layer is ice free, second lowest layer has a solid fraction smaller than phi_s_min/2, and all Nlayer layers are active.</li>
<li>bottom_melt_simple: lowest layer is ice free, second lowest layer has a solid fraction smaller than phi_s_min/2, and not all Nlayer layers are active.</li>
<li>bottom_melt_simple: lowest layer is ice free, second lowest layer has a solid fraction smaller than phi_s_min/2, all Nlayer layers are active, and the thickness of the middle layers equals thick_0</li>
<li>bottom_growth_simple: lowest layer has a solid fraction higher than psi_s_min, and not all Nlayer layers are active</li>
<li>bottom_growth: lowest layer has a solid fraction higher than psi_s_min, and all Nlayer layers are active</li>
<li>top_grow: top layer thicker than 3/2 * thick_0</li>
<li>top_melt: top layer thinner than 1/2 * thick_0</li>
</ul>
<p>If debug_flag is set to 2 the layer values will be written into the debug output (thermoXX.dat) before and after layer dynamics with a string to identify which subroutine was called</p>
<dl class="user"><dt><b>Revision History</b></dt><dd>created by Philipp Griewank, IMPRS (2010-07-29) first complete and hopefully stable version by Philipp Griewank, IMPRS (2010-08-10) </dd></dl>

</div>
</div>
<a class="anchor" id="ad2f5a196bac29bfdc04d442b0b722a24"></a><!-- doxytag: member="mo_layer_dynamics::top_grow" ref="ad2f5a196bac29bfdc04d442b0b722a24" args="(Nlayer, N_active, N_bottom, N_middle, N_top, thick_0, m, S_abs, H_abs, thick, N_bgc, bgc_abs)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mo_layer_dynamics::top_grow </td>
          <td>(</td>
          <td class="paramtype">INTEGER,intent(in)&nbsp;</td>
          <td class="paramname"> <em>Nlayer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">INTEGER,intent(inout)&nbsp;</td>
          <td class="paramname"> <em>N_active</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">INTEGER,intent(in)&nbsp;</td>
          <td class="paramname"> <em>N_bottom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">INTEGER,intent(in)&nbsp;</td>
          <td class="paramname"> <em>N_middle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">INTEGER,intent(in)&nbsp;</td>
          <td class="paramname"> <em>N_top</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL(wp),intent(in)&nbsp;</td>
          <td class="paramname"> <em>thick_0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL(wp),dimension(nlayer),intent(inout)&nbsp;</td>
          <td class="paramname"> <em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL(wp),dimension(nlayer),intent(inout)&nbsp;</td>
          <td class="paramname"> <em>S_abs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL(wp),dimension(nlayer),intent(inout)&nbsp;</td>
          <td class="paramname"> <em>H_abs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL(wp),dimension(nlayer),intent(inout)&nbsp;</td>
          <td class="paramname"> <em>thick</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">INTEGER,intent(in)&nbsp;</td>
          <td class="paramname"> <em>N_bgc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL(wp),dimension(nlayer,n_bgc),intent(inout),optional&nbsp;</td>
          <td class="paramname"> <em>bgc_abs</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Top grow subroutine. </p>
<p>Should be called when the top layer is thicker then 1.5 *thick_0. If N_active=Nlayer middle layers are expanded by thick_0/N_middle and top layers are moved one down. IF N_active&lt;Nlayer then N_active=N_active+1 and all layers are shifted downwards.</p>
<dl class="user"><dt><b>Revision History</b></dt><dd>Started by Philipp Griewank, IMPRS (2011-05-10&gt;) </dd></dl>

</div>
</div>
<a class="anchor" id="aadc5de505c96dad5c7fe5bdb233102a6"></a><!-- doxytag: member="mo_layer_dynamics::top_melt" ref="aadc5de505c96dad5c7fe5bdb233102a6" args="(Nlayer, N_active, N_bottom, N_middle, N_top, thick_0, m, S_abs, H_abs, thick, N_bgc, bgc_abs)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mo_layer_dynamics::top_melt </td>
          <td>(</td>
          <td class="paramtype">INTEGER,intent(in)&nbsp;</td>
          <td class="paramname"> <em>Nlayer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">INTEGER,intent(inout)&nbsp;</td>
          <td class="paramname"> <em>N_active</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">INTEGER,intent(in)&nbsp;</td>
          <td class="paramname"> <em>N_bottom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">INTEGER,intent(in)&nbsp;</td>
          <td class="paramname"> <em>N_middle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">INTEGER,intent(in)&nbsp;</td>
          <td class="paramname"> <em>N_top</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL(wp),intent(in)&nbsp;</td>
          <td class="paramname"> <em>thick_0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL(wp),dimension(nlayer),intent(inout)&nbsp;</td>
          <td class="paramname"> <em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL(wp),dimension(nlayer),intent(inout)&nbsp;</td>
          <td class="paramname"> <em>S_abs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL(wp),dimension(nlayer),intent(inout)&nbsp;</td>
          <td class="paramname"> <em>H_abs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL(wp),dimension(nlayer),intent(inout)&nbsp;</td>
          <td class="paramname"> <em>thick</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">INTEGER,intent(in)&nbsp;</td>
          <td class="paramname"> <em>N_bgc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL(wp),dimension(nlayer,n_bgc),intent(inout),optional&nbsp;</td>
          <td class="paramname"> <em>bgc_abs</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Variables</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address class="footer"><small>Generated on Mon May 26 2014 15:37:21 for SAMSIM by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
