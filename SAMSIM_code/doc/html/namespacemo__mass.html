<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>SAMSIM: mo_mass Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li class="current"><a href="namespaces.html"><span>Modules</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="namespaces.html"><span>Modules&nbsp;List</span></a></li>
      <li><a href="namespacemembers.html"><span>Module&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<h1>mo_mass Module Reference</h1>  </div>
</div>
<div class="contents">

<p>Regulates mass transfers and their results.  
<a href="#_details">More...</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">subroutine&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemo__mass.html#a41bcbec215f56133154de8249421c5cf">mass_transfer</a> (Nlayer, N_active, T, H_abs, S_abs, S_bu, T_bottom, S_bu_bottom, fl_m)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Calculates the effects of mass transfers on H_abs and S_abs.  <a href="#a41bcbec215f56133154de8249421c5cf"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">subroutine&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemo__mass.html#a6e8bfe7e768a83a31407eb4771b1fead">expulsion_flux</a> (thick, V_ex, Nlayer, N_active, psi_g, fl_m, m)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Generates the fluxes caused by expulsion.  <a href="#a6e8bfe7e768a83a31407eb4771b1fead"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">subroutine&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemo__mass.html#aafe4d8270d3f10cd77b9622b40d6da8a">bgc_advection</a> (Nlayer, N_active, N_bgc, fl_brine_bgc, bgc_abs, psi_l, T, S_abs, m, thick, bgc_bottom)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Calculates how the brine fluxes stored in fl_brine_bgc advect bgc tracers.  <a href="#aafe4d8270d3f10cd77b9622b40d6da8a"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Regulates mass transfers and their results. </p>
<p>Ultimately all processes which involve a mass flux should be stored here.</p>
<dl class="author"><dt><b>Author:</b></dt><dd>Philipp Griewank, IMPRS</dd></dl>
<dl class="user"><dt><b>Revision History</b></dt><dd>Begin implementing Expulsion by Philipp Griewank, IMPRS (2010-08-24) </dd></dl>
<hr/><h2>Function/Subroutine Documentation</h2>
<a class="anchor" id="aafe4d8270d3f10cd77b9622b40d6da8a"></a><!-- doxytag: member="mo_mass::bgc_advection" ref="aafe4d8270d3f10cd77b9622b40d6da8a" args="(Nlayer, N_active, N_bgc, fl_brine_bgc, bgc_abs, psi_l, T, S_abs, m, thick, bgc_bottom)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mo_mass::bgc_advection </td>
          <td>(</td>
          <td class="paramtype">INTEGER,intent(in)&nbsp;</td>
          <td class="paramname"> <em>Nlayer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">INTEGER,intent(in)&nbsp;</td>
          <td class="paramname"> <em>N_active</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">INTEGER,intent(in)&nbsp;</td>
          <td class="paramname"> <em>N_bgc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL(wp),dimension(nlayer+1,nlayer+1),intent(in)&nbsp;</td>
          <td class="paramname"> <em>fl_brine_bgc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL(wp),dimension(nlayer,n_bgc),intent(inout)&nbsp;</td>
          <td class="paramname"> <em>bgc_abs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL(wp),dimension(nlayer),intent(in)&nbsp;</td>
          <td class="paramname"> <em>psi_l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL(wp),dimension(nlayer),intent(in)&nbsp;</td>
          <td class="paramname"> <em>T</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL(wp),dimension(nlayer),intent(in)&nbsp;</td>
          <td class="paramname"> <em>S_abs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL(wp),dimension(nlayer),intent(in)&nbsp;</td>
          <td class="paramname"> <em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL(wp),dimension(nlayer),intent(in)&nbsp;</td>
          <td class="paramname"> <em>thick</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL(wp),dimension(n_bgc),intent(in)&nbsp;</td>
          <td class="paramname"> <em>bgc_bottom</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Calculates how the brine fluxes stored in fl_brine_bgc advect bgc tracers. </p>
<p>A very simple upwind strategy is employed. To avoid negative tracer densities, the maximum amount of advection is restricted to the current tracer content in a layer divided by three. Three is chosen as a limit as currently each layer can have a maximum of three flows leaving the layer (to the layer above, the layer below, and the lowest layer). The advection scheme is likely overly diffusive, but given the limitations we are working with (e.g. changing brine volumes) nothing more sophisticated can be applied easily.</p>
<p>For gases it might make sense to limit the brine density to saturation value in advecting brine, to take bubble formation into account. This needs to be specified in bgc_advection, and is a first attempt (both scientifically and code wise) which should be used with caution!</p>
<dl class="user"><dt><b>Revision History</b></dt><dd>Brought to life by Philipp Griewank, IMPRS (2014-02-10) </dd></dl>

</div>
</div>
<a class="anchor" id="a6e8bfe7e768a83a31407eb4771b1fead"></a><!-- doxytag: member="mo_mass::expulsion_flux" ref="a6e8bfe7e768a83a31407eb4771b1fead" args="(thick, V_ex, Nlayer, N_active, psi_g, fl_m, m)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mo_mass::expulsion_flux </td>
          <td>(</td>
          <td class="paramtype">REAL(wp),dimension(nlayer),intent(in)&nbsp;</td>
          <td class="paramname"> <em>thick</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL(wp),dimension(nlayer),intent(in)&nbsp;</td>
          <td class="paramname"> <em>V_ex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">INTEGER,intent(in)&nbsp;</td>
          <td class="paramname"> <em>Nlayer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">INTEGER,intent(in)&nbsp;</td>
          <td class="paramname"> <em>N_active</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL(wp),dimension(nlayer),intent(inout)&nbsp;</td>
          <td class="paramname"> <em>psi_g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL(wp),dimension(nlayer+1),intent(out)&nbsp;</td>
          <td class="paramname"> <em>fl_m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL(wp),dimension(nlayer),intent(inout)&nbsp;</td>
          <td class="paramname"> <em>m</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Generates the fluxes caused by expulsion. </p>
<p>Brine displaced by expansion of a freezing mushy layer lead to a mass, enthalpy and salt flux. This subroutine calculates the amount of brine which moves between the layers caused by V_ex and how the mass in the layers changes. Vary basic assumptions are made. Brine always moves downward (negative), no horizontal movement are allowed and gas pockets can be filled. The upper boundary layer is not permeable but the bottom one is. This subroutine was started as a quick and dirty way to simulate the bottom freezing experiment described in Notz 2005 p. 85</p>
<dl class="user"><dt><b>Revision History</b></dt><dd>Brought to life by Philipp Griewank, IMPRS (2010-08-24) Simplified by Philipp Griewank, IMPRS (2010-11-27) </dd></dl>

</div>
</div>
<a class="anchor" id="a41bcbec215f56133154de8249421c5cf"></a><!-- doxytag: member="mo_mass::mass_transfer" ref="a41bcbec215f56133154de8249421c5cf" args="(Nlayer, N_active, T, H_abs, S_abs, S_bu, T_bottom, S_bu_bottom, fl_m)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mo_mass::mass_transfer </td>
          <td>(</td>
          <td class="paramtype">INTEGER,intent(in)&nbsp;</td>
          <td class="paramname"> <em>Nlayer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">INTEGER,intent(in)&nbsp;</td>
          <td class="paramname"> <em>N_active</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL(wp),dimension(nlayer),intent(in)&nbsp;</td>
          <td class="paramname"> <em>T</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL(wp),dimension(nlayer),intent(inout)&nbsp;</td>
          <td class="paramname"> <em>H_abs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL(wp),dimension(nlayer),intent(inout)&nbsp;</td>
          <td class="paramname"> <em>S_abs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL(wp),dimension(nlayer),intent(in)&nbsp;</td>
          <td class="paramname"> <em>S_bu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL(wp),intent(in)&nbsp;</td>
          <td class="paramname"> <em>T_bottom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL(wp),intent(in)&nbsp;</td>
          <td class="paramname"> <em>S_bu_bottom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL(wp),dimension(nlayer+1),intent(in)&nbsp;</td>
          <td class="paramname"> <em>fl_m</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Calculates the effects of mass transfers on H_abs and S_abs. </p>
<p>The effects of brine displaced by expulsion, flushing or drainage expansion lead to changes in mass, salt ans enthalpy. This subroutine calculates the effects on S_abs and H_abs. A very simple upwind strategy is employed, Brine from below has T and S_br of the lower layer, and brine from above T and S_br of the upper layer. To avoid negative salinity, the maximum amount of advective salt is the total salt content of the layer. The amount of mass transfered is calculated in other subroutines.</p>
<p>This subroutine was started as a quick and dirty way to simulate the bottom freezing experiment described in Notz 2005 p. 85 IMPORTANT: Before this subroutine expelled brine was removed from the system and its effects were determined in subroutine expulsion. S_bu must be up to date!</p>
<dl class="user"><dt><b>Revision History</b></dt><dd>Brought to life by Philipp Griewank, IMPRS (2010-08-24) Modified to work with all processes by Philipp Griewank, IMPRS (2010-11-27) </dd></dl>

</div>
</div>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Variables</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address class="footer"><small>Generated on Mon May 26 2014 15:37:21 for SAMSIM by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
