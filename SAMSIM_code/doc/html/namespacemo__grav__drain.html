<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>SAMSIM: mo_grav_drain Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li class="current"><a href="namespaces.html"><span>Modules</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="namespaces.html"><span>Modules&nbsp;List</span></a></li>
      <li><a href="namespacemembers.html"><span>Module&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<h1>mo_grav_drain Module Reference</h1>  </div>
</div>
<div class="contents">

<p>Computes the Salt fluxes caused by gravity drainage.  
<a href="#_details">More...</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">subroutine&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemo__grav__drain.html#a13446b857aa40114998fffc35b90489d">fl_grav_drain</a> (S_br, S_bu, psi_l, psi_s, psi_g, thick, S_abs, H_abs, T, m, dt, Nlayer, N_active, ray, T_bottom, S_bu_bottom, grav_drain, grav_temp, grav_salt, grav_heat_flag, harmonic_flag, fl_brine_bgc)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Calculates fluxes caused by gravity drainage.  <a href="#a13446b857aa40114998fffc35b90489d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">subroutine&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemo__grav__drain.html#acfbe9a1ea75d02f8e3e85a1f6aeb0ea3">fl_grav_drain_simple</a> (psi_s, psi_l, thick, S_abs, S_br, Nlayer, N_active, ray, grav_drain, harmonic_flag)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Calculates salinity to imitate the effects gravity drainage.  <a href="#acfbe9a1ea75d02f8e3e85a1f6aeb0ea3"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Computes the Salt fluxes caused by gravity drainage. </p>
<dl class="author"><dt><b>Author:</b></dt><dd>&lt;Philipp Griewank, IMPRS&gt;</dd></dl>
<dl class="user"><dt><b>Revision History</b></dt><dd>Injected with life by Philipp Griewank, IMPRS (&lt;2010-08-27&gt;) </dd></dl>
<hr/><h2>Function/Subroutine Documentation</h2>
<a class="anchor" id="a13446b857aa40114998fffc35b90489d"></a><!-- doxytag: member="mo_grav_drain::fl_grav_drain" ref="a13446b857aa40114998fffc35b90489d" args="(S_br, S_bu, psi_l, psi_s, psi_g, thick, S_abs, H_abs, T, m, dt, Nlayer, N_active, ray, T_bottom, S_bu_bottom, grav_drain, grav_temp, grav_salt, grav_heat_flag, harmonic_flag, fl_brine_bgc)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mo_grav_drain::fl_grav_drain </td>
          <td>(</td>
          <td class="paramtype">REAL(wp),dimension(nlayer),intent(in)&nbsp;</td>
          <td class="paramname"> <em>S_br</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL(wp),dimension(nlayer),intent(in)&nbsp;</td>
          <td class="paramname"> <em>S_bu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL(wp),dimension(nlayer),intent(in)&nbsp;</td>
          <td class="paramname"> <em>psi_l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL(wp),dimension(nlayer),intent(in)&nbsp;</td>
          <td class="paramname"> <em>psi_s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL(wp),dimension(nlayer),intent(in)&nbsp;</td>
          <td class="paramname"> <em>psi_g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL(wp),dimension(nlayer),intent(in)&nbsp;</td>
          <td class="paramname"> <em>thick</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL(wp),dimension(nlayer),intent(inout)&nbsp;</td>
          <td class="paramname"> <em>S_abs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL(wp),dimension(nlayer),intent(inout)&nbsp;</td>
          <td class="paramname"> <em>H_abs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL(wp),dimension(nlayer),intent(in)&nbsp;</td>
          <td class="paramname"> <em>T</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL(wp),dimension(nlayer),intent(inout)&nbsp;</td>
          <td class="paramname"> <em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL(wp),intent(in)&nbsp;</td>
          <td class="paramname"> <em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">INTEGER,intent(in)&nbsp;</td>
          <td class="paramname"> <em>Nlayer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">INTEGER,dimension(n_active),intent(in)&nbsp;</td>
          <td class="paramname"> <em>N_active</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL(wp),dimension(nlayer-1),intent(out)&nbsp;</td>
          <td class="paramname"> <em>ray</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL(wp),intent(in)&nbsp;</td>
          <td class="paramname"> <em>T_bottom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL(wp),intent(in)&nbsp;</td>
          <td class="paramname"> <em>S_bu_bottom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL(wp),intent(inout)&nbsp;</td>
          <td class="paramname"> <em>grav_drain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL(wp),intent(inout)&nbsp;</td>
          <td class="paramname"> <em>grav_temp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL(wp),intent(inout)&nbsp;</td>
          <td class="paramname"> <em>grav_salt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">INTEGER,intent(in)&nbsp;</td>
          <td class="paramname"> <em>grav_heat_flag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">INTEGER,intent(in)&nbsp;</td>
          <td class="paramname"> <em>harmonic_flag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL(wp),dimension(nlayer+1,nlayer+1),intent(inout),optional&nbsp;</td>
          <td class="paramname"> <em>fl_brine_bgc</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Calculates fluxes caused by gravity drainage. </p>
<p>If the Rayleigh number of a layer is higher then the critical value, brine leaves the layer by a theoretical brine channel. The discharged brine flows downward through all layers directly into the underlying ocean. To preserve mass the same amount of water flows upwards through all lower layers. In contrast to the downward flux the upward flux is assumed to be in thermal equilibrium thus moving salt and heat to each layer. The upward flux is a standard upwind advection. The downward flux of a layer over the timestep is = x*(Ray-Ray_crit)*dt*thick. _____________________________________ | -&gt;__|__&lt;- |______________| v |__________________ | ^ -&gt;| |&lt;- ^ |______________| |__________________ | ^ ^ -&gt;|||||&lt;- ^ ^ |______________|vvv|__________________ ^ ^ ^ ^ ^ ^ This superb ascii art is supposed to show how the assumed fluxes flow downward through a brine channel and upwards through the layer. x and r are passed on to enable easy optimization. The effect of the upward moving brine is calculated in mass_transfer.</p>
<p>IMPORTANT: The height assumptions are special. The bottom of the ice edge is assumed to be at psi_s(N_active)/psi_s_min *thick_0</p>
<p>The first approach assumed that brine drainage occurred between two layers but performed poorly.</p>
<p>If grav_heat_flag is set to 2 the amount of heat transported out of the ice will be compensated in the lowest layer</p>
<dl class="user"><dt><b>Revision History</b></dt><dd>created by Philipp Griewank, IMPRS (2010-08-27) Completely revised to assume brine channels by Philipp Griewank , IMPRS (2010-11-05) Mass_transfer is used to advect H and S by Philipp Griewank, IMPRS (2010-11-05) Added condition S_br(k)&gt;S_br(k+1) by Philipp Griewank. IMPRS (2011-04-29) Added harmonic mean for permeability by Philipp Griewank (2014-01-05) </dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>ray</em>&nbsp;</td><td>Rayleigh number </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="acfbe9a1ea75d02f8e3e85a1f6aeb0ea3"></a><!-- doxytag: member="mo_grav_drain::fl_grav_drain_simple" ref="acfbe9a1ea75d02f8e3e85a1f6aeb0ea3" args="(psi_s, psi_l, thick, S_abs, S_br, Nlayer, N_active, ray, grav_drain, harmonic_flag)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mo_grav_drain::fl_grav_drain_simple </td>
          <td>(</td>
          <td class="paramtype">REAL(wp),dimension(nlayer),intent(in)&nbsp;</td>
          <td class="paramname"> <em>psi_s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL(wp),dimension(nlayer),intent(in)&nbsp;</td>
          <td class="paramname"> <em>psi_l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL(wp),dimension(nlayer),intent(in)&nbsp;</td>
          <td class="paramname"> <em>thick</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL(wp),dimension(nlayer),intent(inout)&nbsp;</td>
          <td class="paramname"> <em>S_abs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL(wp),dimension(nlayer),intent(in)&nbsp;</td>
          <td class="paramname"> <em>S_br</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">INTEGER,intent(in)&nbsp;</td>
          <td class="paramname"> <em>Nlayer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">INTEGER,intent(in)&nbsp;</td>
          <td class="paramname"> <em>N_active</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL(wp),dimension(nlayer-1),intent(out)&nbsp;</td>
          <td class="paramname"> <em>ray</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL(wp),intent(inout)&nbsp;</td>
          <td class="paramname"> <em>grav_drain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">INTEGER,intent(in)&nbsp;</td>
          <td class="paramname"> <em>harmonic_flag</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Calculates salinity to imitate the effects gravity drainage. </p>
<p>Based on the assumption that super critical Rayleigh numbers are quickly reduced below the critical Rayleigh number. Proposed as a very simplified parametrisation of gravity drainage. Includes no fluxes of any kind, instead bulk salinity is simply reduced when ever the Rayleigh number is above the critical values. The parametrization begins from the bottom layers and moves upward.</p>
<dl class="user"><dt><b>Revision History</b></dt><dd>created by Philipp Griewank, IMPRS (2012-01-01) </dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>ray</em>&nbsp;</td><td>Rayleigh number </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Variables</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address class="footer"><small>Generated on Mon May 26 2014 15:37:21 for SAMSIM by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
