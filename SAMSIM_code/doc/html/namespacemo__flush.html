<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>SAMSIM: mo_flush Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li class="current"><a href="namespaces.html"><span>Modules</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="namespaces.html"><span>Modules&nbsp;List</span></a></li>
      <li><a href="namespacemembers.html"><span>Module&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<h1>mo_flush Module Reference</h1>  </div>
</div>
<div class="contents">

<p>Contains various subroutines for flushing.  
<a href="#_details">More...</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">subroutine&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemo__flush.html#a405b14313a6162816fc9f7cc30501b2e">flush3</a> (freeboard, psi_l, thick, thick_0, S_abs, H_abs, m, T, dt, Nlayer, N_active, T_bottom, S_bu_bottom, melt_thick, debug_flag, flush_heat_flag, fl_brine_bgc)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Subroutine for complex flushing.  <a href="#a405b14313a6162816fc9f7cc30501b2e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">subroutine&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemo__flush.html#aa1fdebea288d239b56f2db40538991f3">flush4</a> (psi_l, thick, T, thick_0, S_abs, H_abs, m, dt, Nlayer, N_active, N_top, N_middle, N_bottom, melt_thick, debug_flag)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">An alternative subroutine for calculating flushing.  <a href="#aa1fdebea288d239b56f2db40538991f3"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Contains various subroutines for flushing. </p>
<p>Which subroutine is called is determined by flush_flag.</p>
<dl class="author"><dt><b>Author:</b></dt><dd>&lt;Philipp Griewank, IMPRS&gt;</dd></dl>
<dl class="user"><dt><b>Revision History</b></dt><dd>Sang into existence for very 1D column by Philipp Griewank, IMPRS (2010-10-20) First stable release by Philipp Griewank, IMPRS (2010-11-27) Freeboard calculation outsourced to <a class="el" href="namespacemo__functions.html" title="Module houses functions which have no home :(.">mo_functions</a> by Philipp Griewank, IMPRS (2010-11-27) Drainage through cracks is added by Philipp Griewank, IMPRS (2011-02-24) </dd></dl>
<hr/><h2>Function/Subroutine Documentation</h2>
<a class="anchor" id="a405b14313a6162816fc9f7cc30501b2e"></a><!-- doxytag: member="mo_flush::flush3" ref="a405b14313a6162816fc9f7cc30501b2e" args="(freeboard, psi_l, thick, thick_0, S_abs, H_abs, m, T, dt, Nlayer, N_active, T_bottom, S_bu_bottom, melt_thick, debug_flag, flush_heat_flag, fl_brine_bgc)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mo_flush::flush3 </td>
          <td>(</td>
          <td class="paramtype">REAL(wp),intent(in)&nbsp;</td>
          <td class="paramname"> <em>freeboard</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL(wp),dimension(nlayer),intent(in)&nbsp;</td>
          <td class="paramname"> <em>psi_l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL(wp),dimension(nlayer),intent(inout)&nbsp;</td>
          <td class="paramname"> <em>thick</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL(wp),intent(in)&nbsp;</td>
          <td class="paramname"> <em>thick_0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL(wp),dimension(nlayer),intent(inout)&nbsp;</td>
          <td class="paramname"> <em>S_abs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL(wp),dimension(nlayer),intent(inout)&nbsp;</td>
          <td class="paramname"> <em>H_abs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL(wp),dimension(nlayer),intent(inout)&nbsp;</td>
          <td class="paramname"> <em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL(wp),dimension(nlayer),intent(in)&nbsp;</td>
          <td class="paramname"> <em>T</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL(wp),intent(in)&nbsp;</td>
          <td class="paramname"> <em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">INTEGER,intent(in)&nbsp;</td>
          <td class="paramname"> <em>Nlayer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">INTEGER,intent(inout)&nbsp;</td>
          <td class="paramname"> <em>N_active</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL(wp),intent(in)&nbsp;</td>
          <td class="paramname"> <em>T_bottom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL(wp),intent(in)&nbsp;</td>
          <td class="paramname"> <em>S_bu_bottom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL(wp),intent(inout)&nbsp;</td>
          <td class="paramname"> <em>melt_thick</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">INTEGER,intent(in)&nbsp;</td>
          <td class="paramname"> <em>debug_flag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">INTEGER,intent(in)&nbsp;</td>
          <td class="paramname"> <em>flush_heat_flag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL(wp),dimension(nlayer+1,nlayer+1),intent(inout),optional&nbsp;</td>
          <td class="paramname"> <em>fl_brine_bgc</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Subroutine for complex flushing. </p>
<p>Each layer splits the flushing brine into a fraction that moves downward, and a fraction that leaves the ice. A fraction of the top layer is considered melt water. This approach uses hydraulic resistivity R = mu*thick/perm . The hydraulic head is assumed to be the freeboard. The vertical resistance R_v of each layer is a determined by its viscosity * thickness divided by it's permeability. Additionally, each layer is given horizontal resistivity R_h. It is assumed that there is an average length horizontally which brine needs to flow to reach a drainage feature in the ice. We assume this length is a linear function of the ice thickness. The only tuning parameter is para_flush_horiz. The total resistance of layer i to the bottom is R.</p>
<p>For flush_heat_flag==2 the amount of heat which leaves by dynamics from the lowest layer is added to the lowest layer to keep results comparable to the other approaches. See PhD Griewank for details</p>
<dl class="user"><dt><b>Revision History</b></dt><dd>Invented by Philipp Griewank, IMPRS (2012-06-15) Trying to add brine fluxes by Philipp Griewank, IMPRS (2014-02-01) </dd></dl>

</div>
</div>
<a class="anchor" id="aa1fdebea288d239b56f2db40538991f3"></a><!-- doxytag: member="mo_flush::flush4" ref="aa1fdebea288d239b56f2db40538991f3" args="(psi_l, thick, T, thick_0, S_abs, H_abs, m, dt, Nlayer, N_active, N_top, N_middle, N_bottom, melt_thick, debug_flag)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mo_flush::flush4 </td>
          <td>(</td>
          <td class="paramtype">REAL(wp),dimension(nlayer),intent(in)&nbsp;</td>
          <td class="paramname"> <em>psi_l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL(wp),dimension(nlayer),intent(inout)&nbsp;</td>
          <td class="paramname"> <em>thick</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL(wp),dimension(nlayer),intent(in)&nbsp;</td>
          <td class="paramname"> <em>T</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL(wp),intent(in)&nbsp;</td>
          <td class="paramname"> <em>thick_0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL(wp),dimension(nlayer),intent(inout)&nbsp;</td>
          <td class="paramname"> <em>S_abs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL(wp),dimension(nlayer),intent(inout)&nbsp;</td>
          <td class="paramname"> <em>H_abs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL(wp),dimension(nlayer),intent(inout)&nbsp;</td>
          <td class="paramname"> <em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL(wp),intent(in)&nbsp;</td>
          <td class="paramname"> <em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">INTEGER,intent(in)&nbsp;</td>
          <td class="paramname"> <em>Nlayer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">INTEGER,intent(in)&nbsp;</td>
          <td class="paramname"> <em>N_active</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">INTEGER,intent(in)&nbsp;</td>
          <td class="paramname"> <em>N_top</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">INTEGER,intent(in)&nbsp;</td>
          <td class="paramname"> <em>N_middle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">INTEGER,intent(in)&nbsp;</td>
          <td class="paramname"> <em>N_bottom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">REAL(wp),intent(inout)&nbsp;</td>
          <td class="paramname"> <em>melt_thick</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">INTEGER,intent(in)&nbsp;</td>
          <td class="paramname"> <em>debug_flag</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>An alternative subroutine for calculating flushing. </p>
<p>Simplified approach. Melt_thick of top layer is simply removed with brine salinity. Salinity of a layer is reduced if the solid fraction is lower than that of the layer above it. Flushing stops as soon as a layer has a higher solid fraction than the layer below it.</p>
<dl class="user"><dt><b>Revision History</b></dt><dd>Invented by Philipp Griewank, IMPRS (2012-07-9) </dd></dl>

</div>
</div>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Variables</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address class="footer"><small>Generated on Mon May 26 2014 15:37:21 for SAMSIM by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
